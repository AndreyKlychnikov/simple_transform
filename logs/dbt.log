

============================== 2022-05-27 14:24:53.309307 | 4e35926b-213b-4280-b9c9-7582a7aa9265 ==============================
14:24:53.309343 [info ] [MainThread]: Running with dbt=1.1.0
14:24:53.309893 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
14:24:53.310095 [debug] [MainThread]: Tracking: do not track
14:24:53.324570 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
14:24:53.334894 [debug] [MainThread]: Parsing macros/relations.sql
14:24:53.337173 [debug] [MainThread]: Parsing macros/adapters.sql
14:24:53.357687 [debug] [MainThread]: Parsing macros/catalog.sql
14:24:53.359753 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
14:24:53.361319 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
14:24:53.364120 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
14:24:53.366701 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
14:24:53.373663 [debug] [MainThread]: Parsing macros/adapters/columns.sql
14:24:53.382671 [debug] [MainThread]: Parsing macros/adapters/relation.sql
14:24:53.391931 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
14:24:53.396533 [debug] [MainThread]: Parsing macros/adapters/schema.sql
14:24:53.398706 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
14:24:53.402460 [debug] [MainThread]: Parsing macros/materializations/configs.sql
14:24:53.404765 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
14:24:53.407495 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
14:24:53.409782 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
14:24:53.411103 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
14:24:53.417611 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
14:24:53.420437 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
14:24:53.427300 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
14:24:53.441840 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
14:24:53.455775 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
14:24:53.460260 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
14:24:53.461802 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
14:24:53.471410 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
14:24:53.473038 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
14:24:53.482888 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
14:24:53.499235 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
14:24:53.511118 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
14:24:53.526130 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
14:24:53.531892 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
14:24:53.536049 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
14:24:53.537778 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
14:24:53.539545 [debug] [MainThread]: Parsing macros/etc/datetime.sql
14:24:53.547266 [debug] [MainThread]: Parsing macros/etc/statement.sql
14:24:53.551530 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
14:24:53.553088 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
14:24:53.555456 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
14:24:53.556945 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
14:24:53.557654 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
14:24:53.559119 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
14:24:53.560027 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
14:24:53.560869 [debug] [MainThread]: Parsing tests/generic/builtin.sql
14:24:53.746576 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
14:24:53.757681 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
14:24:53.760394 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
14:24:53.763074 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
14:24:53.765713 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fct_orders.sql
14:24:53.768395 [debug] [MainThread]: 1699: static parser successfully parsed marts/marketing/customer_orders.sql
14:24:53.892898 [info ] [MainThread]: Found 6 models, 10 tests, 1 snapshot, 0 analyses, 167 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
14:24:53.894298 [info ] [MainThread]: 
14:24:53.894837 [debug] [MainThread]: Acquiring new postgres connection "master"
14:24:53.895549 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
14:24:53.904178 [debug] [ThreadPool]: Using postgres connection "list_dbt"
14:24:53.904395 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
14:24:53.904582 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:24:53.908748 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:24:53.909955 [debug] [ThreadPool]: On list_dbt: Close
14:24:53.911267 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_snapshots"
14:24:53.916851 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
14:24:53.917207 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
14:24:53.917396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:24:53.920602 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:24:53.920891 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
14:24:53.921073 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
14:24:53.923141 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
14:24:53.924244 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
14:24:53.924612 [debug] [ThreadPool]: On list_dbt_snapshots: Close
14:24:53.925111 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_warehouse"
14:24:53.926703 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
14:24:53.926902 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
14:24:53.927080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:24:53.929997 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:24:53.930238 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
14:24:53.930417 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
14:24:53.932322 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
14:24:53.933412 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
14:24:53.933817 [debug] [ThreadPool]: On list_dbt_warehouse: Close
14:24:53.937724 [debug] [MainThread]: Using postgres connection "master"
14:24:53.937946 [debug] [MainThread]: On master: BEGIN
14:24:53.938132 [debug] [MainThread]: Opening a new connection, currently in state init
14:24:53.941316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:24:53.941567 [debug] [MainThread]: Using postgres connection "master"
14:24:53.941762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:24:53.948968 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:24:53.950087 [debug] [MainThread]: On master: ROLLBACK
14:24:53.950569 [debug] [MainThread]: Using postgres connection "master"
14:24:53.950793 [debug] [MainThread]: On master: BEGIN
14:24:53.951464 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:24:53.951703 [debug] [MainThread]: On master: COMMIT
14:24:53.951901 [debug] [MainThread]: Using postgres connection "master"
14:24:53.952094 [debug] [MainThread]: On master: COMMIT
14:24:53.952495 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:24:53.952703 [debug] [MainThread]: On master: Close
14:24:53.953083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:24:53.953488 [info ] [MainThread]: 
14:24:53.966163 [debug] [Thread-1  ]: Began running node snapshot.sde_dbt_tutorial.customers_snapshot
14:24:53.967639 [info ] [Thread-1  ]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
14:24:53.970052 [debug] [Thread-1  ]: Acquiring new postgres connection "snapshot.sde_dbt_tutorial.customers_snapshot"
14:24:53.971011 [debug] [Thread-1  ]: Began compiling node snapshot.sde_dbt_tutorial.customers_snapshot
14:24:53.972006 [debug] [Thread-1  ]: Compiling snapshot.sde_dbt_tutorial.customers_snapshot
14:24:53.984325 [debug] [Thread-1  ]: finished collecting timing info
14:24:53.985451 [debug] [Thread-1  ]: Began executing node snapshot.sde_dbt_tutorial.customers_snapshot
14:24:54.048695 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.sde_dbt_tutorial.customers_snapshot"
14:24:54.049170 [debug] [Thread-1  ]: Using postgres connection "snapshot.sde_dbt_tutorial.customers_snapshot"
14:24:54.049376 [debug] [Thread-1  ]: On snapshot.sde_dbt_tutorial.customers_snapshot: BEGIN
14:24:54.049557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:24:54.052652 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:24:54.052901 [debug] [Thread-1  ]: Using postgres connection "snapshot.sde_dbt_tutorial.customers_snapshot"
14:24:54.053086 [debug] [Thread-1  ]: On snapshot.sde_dbt_tutorial.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "snapshot.sde_dbt_tutorial.customers_snapshot"} */

      

  create  table "dbt"."snapshots"."customers_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id,
        datetime_updated as dbt_updated_at,
        datetime_updated as dbt_valid_from,
        nullif(datetime_updated, datetime_updated) as dbt_valid_to
    from (
        



select * from "dbt"."warehouse"."customers"

    ) sbq



  );
  
14:24:54.060295 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
14:24:54.070010 [debug] [Thread-1  ]: On snapshot.sde_dbt_tutorial.customers_snapshot: COMMIT
14:24:54.070230 [debug] [Thread-1  ]: Using postgres connection "snapshot.sde_dbt_tutorial.customers_snapshot"
14:24:54.070417 [debug] [Thread-1  ]: On snapshot.sde_dbt_tutorial.customers_snapshot: COMMIT
14:24:54.073014 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:24:54.073508 [debug] [Thread-1  ]: finished collecting timing info
14:24:54.073724 [debug] [Thread-1  ]: On snapshot.sde_dbt_tutorial.customers_snapshot: Close
14:24:54.074257 [info ] [Thread-1  ]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32mSELECT 100[0m in 0.10s]
14:24:54.074788 [debug] [Thread-1  ]: Finished running node snapshot.sde_dbt_tutorial.customers_snapshot
14:24:54.171269 [debug] [MainThread]: Acquiring new postgres connection "master"
14:24:54.172451 [debug] [MainThread]: Using postgres connection "master"
14:24:54.173331 [debug] [MainThread]: On master: BEGIN
14:24:54.174156 [debug] [MainThread]: Opening a new connection, currently in state closed
14:24:54.184871 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:24:54.185996 [debug] [MainThread]: On master: COMMIT
14:24:54.186973 [debug] [MainThread]: Using postgres connection "master"
14:24:54.187959 [debug] [MainThread]: On master: COMMIT
14:24:54.189677 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:24:54.190802 [debug] [MainThread]: On master: Close
14:24:54.192470 [info ] [MainThread]: 
14:24:54.194341 [info ] [MainThread]: Finished running 1 snapshot in 0.30s.
14:24:54.196070 [debug] [MainThread]: Connection 'master' was properly closed.
14:24:54.196925 [debug] [MainThread]: Connection 'snapshot.sde_dbt_tutorial.customers_snapshot' was properly closed.
14:24:54.215223 [info ] [MainThread]: 
14:24:54.216740 [info ] [MainThread]: [32mCompleted successfully[0m
14:24:54.217994 [info ] [MainThread]: 
14:24:54.219084 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2022-05-27 14:26:44.264052 | 82596a7a-7426-46e6-b43a-cf68f9be1b17 ==============================
14:26:44.264075 [info ] [MainThread]: Running with dbt=1.1.0
14:26:44.264641 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:26:44.264841 [debug] [MainThread]: Tracking: do not track
14:26:44.295501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:26:44.295822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:26:44.306990 [info ] [MainThread]: Found 6 models, 10 tests, 1 snapshot, 0 analyses, 167 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
14:26:44.308510 [info ] [MainThread]: 
14:26:44.309057 [debug] [MainThread]: Acquiring new postgres connection "master"
14:26:44.310050 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
14:26:44.318991 [debug] [ThreadPool]: Using postgres connection "list_dbt"
14:26:44.319243 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
14:26:44.319432 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:26:44.323516 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:26:44.324806 [debug] [ThreadPool]: On list_dbt: Close
14:26:44.326095 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_warehouse"
14:26:44.331289 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
14:26:44.331602 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
14:26:44.331787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:26:44.334965 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:26:44.335177 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
14:26:44.335359 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
14:26:44.337265 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
14:26:44.338357 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
14:26:44.338779 [debug] [ThreadPool]: On list_dbt_warehouse: Close
14:26:44.339266 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_snapshots"
14:26:44.340782 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
14:26:44.340984 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
14:26:44.341163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:26:44.344056 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:26:44.344284 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
14:26:44.344469 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
14:26:44.346302 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
14:26:44.347292 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
14:26:44.347664 [debug] [ThreadPool]: On list_dbt_snapshots: Close
14:26:44.351394 [debug] [MainThread]: Using postgres connection "master"
14:26:44.351613 [debug] [MainThread]: On master: BEGIN
14:26:44.351794 [debug] [MainThread]: Opening a new connection, currently in state init
14:26:44.354891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:26:44.355103 [debug] [MainThread]: Using postgres connection "master"
14:26:44.355287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:26:44.362288 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:26:44.363439 [debug] [MainThread]: On master: ROLLBACK
14:26:44.363931 [debug] [MainThread]: Using postgres connection "master"
14:26:44.364172 [debug] [MainThread]: On master: BEGIN
14:26:44.364854 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:26:44.365096 [debug] [MainThread]: On master: COMMIT
14:26:44.365301 [debug] [MainThread]: Using postgres connection "master"
14:26:44.365495 [debug] [MainThread]: On master: COMMIT
14:26:44.365901 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:26:44.366137 [debug] [MainThread]: On master: Close
14:26:44.366540 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:26:44.366953 [info ] [MainThread]: 
14:26:44.368835 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__customers
14:26:44.369165 [info ] [Thread-1  ]: 1 of 6 START view model warehouse.stg_eltool__customers ........................ [RUN]
14:26:44.369734 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__customers"
14:26:44.369958 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__customers
14:26:44.370179 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__customers
14:26:44.372536 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__customers"
14:26:44.373005 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.373236 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__customers
14:26:44.395815 [debug] [Thread-1  ]: Writing runtime SQL for node "model.sde_dbt_tutorial.stg_eltool__customers"
14:26:44.396280 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__customers"
14:26:44.396480 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__customers: BEGIN
14:26:44.396662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:26:44.400021 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:26:44.400265 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__customers"
14:26:44.400451 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.stg_eltool__customers"} */

  create view "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
14:26:44.402259 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:26:44.407829 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__customers"
14:26:44.408049 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
14:26:44.408680 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:26:44.414693 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__customers: COMMIT
14:26:44.414912 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__customers"
14:26:44.415094 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__customers: COMMIT
14:26:44.417470 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:26:44.421592 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__customers"
14:26:44.421793 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.stg_eltool__customers"} */
drop view if exists "dbt"."warehouse"."stg_eltool__customers__dbt_backup" cascade
14:26:44.422310 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:26:44.423368 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.423591 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__customers: Close
14:26:44.424080 [info ] [Thread-1  ]: 1 of 6 OK created view model warehouse.stg_eltool__customers ................... [[32mCREATE VIEW[0m in 0.05s]
14:26:44.424592 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__customers
14:26:44.424826 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__orders
14:26:44.425089 [info ] [Thread-1  ]: 2 of 6 START view model warehouse.stg_eltool__orders ........................... [RUN]
14:26:44.425573 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__orders"
14:26:44.425775 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__orders
14:26:44.425965 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__orders
14:26:44.427905 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__orders"
14:26:44.428325 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.428543 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__orders
14:26:44.430556 [debug] [Thread-1  ]: Writing runtime SQL for node "model.sde_dbt_tutorial.stg_eltool__orders"
14:26:44.430856 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__orders"
14:26:44.431047 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__orders: BEGIN
14:26:44.431226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:26:44.434349 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:26:44.434565 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__orders"
14:26:44.434749 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.stg_eltool__orders"} */

  create view "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."warehouse"."orders"
),
renamed as (
    select order_id,
        cust_id AS customer_id,
        order_status,
        order_purchase_timestamp::TIMESTAMP,
        order_approved_at::TIMESTAMP,
        order_delivered_carrier_date::TIMESTAMP,
        order_delivered_customer_date::TIMESTAMP,
        order_estimated_delivery_date::TIMESTAMP
        from source
)
select *
from renamed
  );
14:26:44.436401 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:26:44.439509 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__orders"
14:26:44.439945 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
14:26:44.440615 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:26:44.441935 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__orders: COMMIT
14:26:44.442150 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__orders"
14:26:44.442350 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__orders: COMMIT
14:26:44.444436 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:26:44.446076 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__orders"
14:26:44.446270 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.stg_eltool__orders"} */
drop view if exists "dbt"."warehouse"."stg_eltool__orders__dbt_backup" cascade
14:26:44.446746 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:26:44.447670 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.447887 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__orders: Close
14:26:44.448349 [info ] [Thread-1  ]: 2 of 6 OK created view model warehouse.stg_eltool__orders ...................... [[32mCREATE VIEW[0m in 0.02s]
14:26:44.448829 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__orders
14:26:44.449063 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__state
14:26:44.449325 [info ] [Thread-1  ]: 3 of 6 START view model warehouse.stg_eltool__state ............................ [RUN]
14:26:44.449812 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
14:26:44.450010 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__state
14:26:44.450199 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__state
14:26:44.452224 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__state"
14:26:44.452706 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.452916 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__state
14:26:44.454850 [debug] [Thread-1  ]: Writing runtime SQL for node "model.sde_dbt_tutorial.stg_eltool__state"
14:26:44.455149 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
14:26:44.455337 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__state: BEGIN
14:26:44.455516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:26:44.458776 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:26:44.459044 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
14:26:44.459233 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.stg_eltool__state"} */

  create view "dbt"."warehouse"."stg_eltool__state__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."warehouse"."state"
),
renamed as (
    select state_identifier::INT AS state_id,
        state_code::VARCHAR(2) AS state_code,
        st_name::VARCHAR(30) AS state_name
    from source
)
select *
from renamed
  );
14:26:44.460960 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:26:44.463377 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
14:26:44.463592 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
14:26:44.464119 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:26:44.465308 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__state: COMMIT
14:26:44.465505 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
14:26:44.465685 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__state: COMMIT
14:26:44.467505 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:26:44.469116 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
14:26:44.469315 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.stg_eltool__state"} */
drop view if exists "dbt"."warehouse"."stg_eltool__state__dbt_backup" cascade
14:26:44.469825 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:26:44.470768 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.470991 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.stg_eltool__state: Close
14:26:44.471475 [info ] [Thread-1  ]: 3 of 6 OK created view model warehouse.stg_eltool__state ....................... [[32mCREATE VIEW[0m in 0.02s]
14:26:44.471989 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__state
14:26:44.472236 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.fct_orders
14:26:44.472503 [info ] [Thread-1  ]: 4 of 6 START table model warehouse.fct_orders .................................. [RUN]
14:26:44.473015 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.fct_orders"
14:26:44.473218 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.fct_orders
14:26:44.473409 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.fct_orders
14:26:44.475397 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.fct_orders"
14:26:44.475984 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.476204 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.fct_orders
14:26:44.495941 [debug] [Thread-1  ]: Writing runtime SQL for node "model.sde_dbt_tutorial.fct_orders"
14:26:44.496417 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.fct_orders"
14:26:44.496616 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.fct_orders: BEGIN
14:26:44.496803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:26:44.500129 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:26:44.500399 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.fct_orders"
14:26:44.500586 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.fct_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.fct_orders"} */


  create  table "dbt"."warehouse"."fct_orders__dbt_tmp"
  as (
    with orders as (
    select *
    from "dbt"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
14:26:44.504592 [debug] [Thread-1  ]: SQL status: SELECT 999 in 0.0 seconds
14:26:44.506961 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.fct_orders"
14:26:44.507187 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.fct_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.fct_orders"} */
alter table "dbt"."warehouse"."fct_orders__dbt_tmp" rename to "fct_orders"
14:26:44.507784 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:26:44.513062 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.fct_orders: COMMIT
14:26:44.513331 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.fct_orders"
14:26:44.513526 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.fct_orders: COMMIT
14:26:44.517128 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:26:44.521575 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.fct_orders"
14:26:44.521843 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.fct_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.fct_orders"} */
drop table if exists "dbt"."warehouse"."fct_orders__dbt_backup" cascade
14:26:44.522377 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
14:26:44.524244 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.524536 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.fct_orders: Close
14:26:44.525037 [info ] [Thread-1  ]: 4 of 6 OK created table model warehouse.fct_orders ............................. [[32mSELECT 999[0m in 0.05s]
14:26:44.525543 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.fct_orders
14:26:44.525776 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.dim_customers
14:26:44.526039 [info ] [Thread-1  ]: 5 of 6 START table model warehouse.dim_customers ............................... [RUN]
14:26:44.526535 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.dim_customers"
14:26:44.526735 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.dim_customers
14:26:44.526931 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.dim_customers
14:26:44.529256 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.dim_customers"
14:26:44.529634 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.529839 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.dim_customers
14:26:44.532338 [debug] [Thread-1  ]: Writing runtime SQL for node "model.sde_dbt_tutorial.dim_customers"
14:26:44.532657 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.dim_customers"
14:26:44.532851 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.dim_customers: BEGIN
14:26:44.533044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:26:44.535951 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:26:44.536190 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.dim_customers"
14:26:44.536389 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.dim_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.dim_customers"} */


  create  table "dbt"."warehouse"."dim_customers__dbt_tmp"
  as (
    with customers as (
    select *
    from "dbt"."warehouse"."stg_eltool__customers"
),
state as (
    select *
    from "dbt"."warehouse"."stg_eltool__state"
)
select c.customer_id,
    c.zipcode,
    c.city,
    c.state_code,
    s.state_name,
    c.datetime_created,
    c.datetime_updated,
    c.dbt_valid_from::TIMESTAMP as valid_from,
    CASE
        WHEN c.dbt_valid_to IS NULL THEN '9999-12-31'::TIMESTAMP
        ELSE c.dbt_valid_to::TIMESTAMP
    END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
14:26:44.538801 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
14:26:44.541155 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.dim_customers"
14:26:44.541387 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.dim_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.dim_customers"} */
alter table "dbt"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
14:26:44.542020 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:26:44.544068 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.dim_customers: COMMIT
14:26:44.544275 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.dim_customers"
14:26:44.544454 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.dim_customers: COMMIT
14:26:44.546935 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:26:44.554170 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.dim_customers"
14:26:44.555098 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.dim_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.dim_customers"} */
drop table if exists "dbt"."warehouse"."dim_customers__dbt_backup" cascade
14:26:44.556909 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
14:26:44.561323 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.562340 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.dim_customers: Close
14:26:44.564350 [info ] [Thread-1  ]: 5 of 6 OK created table model warehouse.dim_customers .......................... [[32mSELECT 100[0m in 0.04s]
14:26:44.566232 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.dim_customers
14:26:44.567433 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.customer_orders
14:26:44.568284 [info ] [Thread-1  ]: 6 of 6 START view model warehouse.customer_orders .............................. [RUN]
14:26:44.569843 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.customer_orders"
14:26:44.570531 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.customer_orders
14:26:44.570986 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.customer_orders
14:26:44.578101 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.customer_orders"
14:26:44.578793 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.579191 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.customer_orders
14:26:44.583089 [debug] [Thread-1  ]: Writing runtime SQL for node "model.sde_dbt_tutorial.customer_orders"
14:26:44.583793 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.customer_orders"
14:26:44.584134 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.customer_orders: BEGIN
14:26:44.584468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:26:44.588640 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:26:44.588984 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.customer_orders"
14:26:44.589271 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.customer_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.customer_orders"} */

  create view "dbt"."warehouse"."customer_orders__dbt_tmp" as (
    with orders as (
    select *
    from "dbt"."warehouse"."fct_orders"
),
customers as (
    select *
    from "dbt"."warehouse"."dim_customers"
)
select o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp,
    o.order_approved_at,
    o.order_delivered_carrier_date,
    o.order_delivered_customer_date,
    o.order_estimated_delivery_date,
    c.zipcode as customer_zipcode,
    c.city as customer_city,
    c.state_code as customer_state_code,
    c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
14:26:44.591747 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:26:44.594443 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.customer_orders"
14:26:44.594697 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.customer_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.customer_orders"} */
alter table "dbt"."warehouse"."customer_orders__dbt_tmp" rename to "customer_orders"
14:26:44.595392 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:26:44.596924 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.customer_orders: COMMIT
14:26:44.597129 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.customer_orders"
14:26:44.597318 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.customer_orders: COMMIT
14:26:44.598340 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:26:44.600068 [debug] [Thread-1  ]: Using postgres connection "model.sde_dbt_tutorial.customer_orders"
14:26:44.600296 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.customer_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "model.sde_dbt_tutorial.customer_orders"} */
drop view if exists "dbt"."warehouse"."customer_orders__dbt_backup" cascade
14:26:44.600719 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:26:44.601620 [debug] [Thread-1  ]: finished collecting timing info
14:26:44.601849 [debug] [Thread-1  ]: On model.sde_dbt_tutorial.customer_orders: Close
14:26:44.602345 [info ] [Thread-1  ]: 6 of 6 OK created view model warehouse.customer_orders ......................... [[32mCREATE VIEW[0m in 0.03s]
14:26:44.602875 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.customer_orders
14:26:44.672037 [debug] [MainThread]: Acquiring new postgres connection "master"
14:26:44.673169 [debug] [MainThread]: Using postgres connection "master"
14:26:44.674056 [debug] [MainThread]: On master: BEGIN
14:26:44.674871 [debug] [MainThread]: Opening a new connection, currently in state closed
14:26:44.686143 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:26:44.687190 [debug] [MainThread]: On master: COMMIT
14:26:44.688097 [debug] [MainThread]: Using postgres connection "master"
14:26:44.688981 [debug] [MainThread]: On master: COMMIT
14:26:44.690486 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:26:44.691555 [debug] [MainThread]: On master: Close
14:26:44.693336 [info ] [MainThread]: 
14:26:44.695145 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.38s.
14:26:44.696857 [debug] [MainThread]: Connection 'master' was properly closed.
14:26:44.697681 [debug] [MainThread]: Connection 'model.sde_dbt_tutorial.customer_orders' was properly closed.
14:26:44.714626 [info ] [MainThread]: 
14:26:44.715832 [info ] [MainThread]: [32mCompleted successfully[0m
14:26:44.716760 [info ] [MainThread]: 
14:26:44.717550 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6


============================== 2022-05-27 14:31:44.456177 | ad5d7774-7c44-4fd8-a99e-8841a45c0497 ==============================
14:31:44.456213 [info ] [MainThread]: Running with dbt=1.1.0
14:31:44.457210 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
14:31:44.457464 [debug] [MainThread]: Tracking: do not track
14:31:44.492849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:31:44.493167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:31:44.504428 [info ] [MainThread]: Found 6 models, 10 tests, 1 snapshot, 0 analyses, 167 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
14:31:44.506230 [info ] [MainThread]: 
14:31:44.506882 [debug] [MainThread]: Acquiring new postgres connection "master"
14:31:44.508041 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_warehouse"
14:31:44.517143 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
14:31:44.517384 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
14:31:44.517573 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:31:44.521155 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:31:44.521492 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
14:31:44.521701 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
14:31:44.523670 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
14:31:44.525184 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
14:31:44.525658 [debug] [ThreadPool]: On list_dbt_warehouse: Close
14:31:44.526203 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_snapshots"
14:31:44.528210 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
14:31:44.528794 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
14:31:44.528998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:31:44.532040 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:31:44.532285 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
14:31:44.532484 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
14:31:44.534420 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.535489 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
14:31:44.535967 [debug] [ThreadPool]: On list_dbt_snapshots: Close
14:31:44.539890 [debug] [MainThread]: Using postgres connection "master"
14:31:44.540144 [debug] [MainThread]: On master: BEGIN
14:31:44.540341 [debug] [MainThread]: Opening a new connection, currently in state init
14:31:44.543572 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:31:44.543864 [debug] [MainThread]: Using postgres connection "master"
14:31:44.544063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:31:44.555611 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
14:31:44.557127 [debug] [MainThread]: On master: ROLLBACK
14:31:44.557587 [debug] [MainThread]: Using postgres connection "master"
14:31:44.557796 [debug] [MainThread]: On master: BEGIN
14:31:44.558447 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:31:44.558667 [debug] [MainThread]: On master: COMMIT
14:31:44.558862 [debug] [MainThread]: Using postgres connection "master"
14:31:44.559048 [debug] [MainThread]: On master: COMMIT
14:31:44.559385 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:31:44.559606 [debug] [MainThread]: On master: Close
14:31:44.559975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:31:44.560361 [info ] [MainThread]: 
14:31:44.562140 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:44.562398 [info ] [Thread-1  ]: 1 of 10 START test accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
14:31:44.562923 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3"
14:31:44.563128 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:44.563335 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:44.576695 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3"
14:31:44.577137 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.577358 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:44.592353 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3"
14:31:44.592780 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3"
14:31:44.592980 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3: BEGIN
14:31:44.593161 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.596435 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.596701 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3"
14:31:44.596910 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "dbt"."warehouse"."customer_orders"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
14:31:44.598700 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.600509 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.600742 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3: ROLLBACK
14:31:44.601165 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3: Close
14:31:44.601606 [info ] [Thread-1  ]: 1 of 10 PASS accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.04s]
14:31:44.602139 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:44.602386 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:44.602592 [info ] [Thread-1  ]: 2 of 10 START test assert_customer_dimension_has_no_row_loss ................... [RUN]
14:31:44.603091 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss"
14:31:44.603299 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:44.603494 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:44.606473 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss"
14:31:44.607000 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.607356 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:44.609290 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss"
14:31:44.609723 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss"
14:31:44.609922 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss: BEGIN
14:31:44.610102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.613222 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.613460 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss"
14:31:44.613649 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
        select dim_cust.customer_id
        from "dbt"."warehouse"."dim_customers" dim_cust
            left join "dbt"."warehouse"."stg_eltool__customers" stg_cust on dim_cust.customer_id = stg_cust.customer_id
        where stg_cust.customer_id is null
        UNION ALL
        select stg_cust.customer_id
        from "dbt"."warehouse"."stg_eltool__customers" stg_cust
            left join "dbt"."warehouse"."dim_customers" dim_cust on stg_cust.customer_id = dim_cust.customer_id
        where dim_cust.customer_id is null
    ) tmp
      
    ) dbt_internal_test
14:31:44.615170 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.616349 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.616599 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss: ROLLBACK
14:31:44.616991 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss: Close
14:31:44.617370 [info ] [Thread-1  ]: 2 of 10 PASS assert_customer_dimension_has_no_row_loss ......................... [[32mPASS[0m in 0.01s]
14:31:44.617903 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:44.618135 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:44.618336 [info ] [Thread-1  ]: 3 of 10 START test not_null_customer_orders_customer_id ........................ [RUN]
14:31:44.618926 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0"
14:31:44.619139 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:44.619335 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:44.625760 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0"
14:31:44.626136 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.626348 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:44.629194 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0"
14:31:44.629584 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0"
14:31:44.629796 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0: BEGIN
14:31:44.629998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.633287 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.633521 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0"
14:31:44.633713 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."warehouse"."customer_orders"
where customer_id is null



      
    ) dbt_internal_test
14:31:44.635649 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.636916 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.637164 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0: ROLLBACK
14:31:44.637622 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0: Close
14:31:44.638043 [info ] [Thread-1  ]: 3 of 10 PASS not_null_customer_orders_customer_id .............................. [[32mPASS[0m in 0.02s]
14:31:44.638539 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:44.638777 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:44.638978 [info ] [Thread-1  ]: 4 of 10 START test not_null_dim_customers_customer_id .......................... [RUN]
14:31:44.639468 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d"
14:31:44.639677 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:44.639871 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:44.643420 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d"
14:31:44.643977 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.644235 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:44.645913 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d"
14:31:44.646301 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d"
14:31:44.646499 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
14:31:44.646679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.650060 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.650322 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d"
14:31:44.650512 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."warehouse"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
14:31:44.651290 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.652628 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.652852 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
14:31:44.653276 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d: Close
14:31:44.653698 [info ] [Thread-1  ]: 4 of 10 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.01s]
14:31:44.654221 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:44.654464 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:44.654670 [info ] [Thread-1  ]: 5 of 10 START test not_null_stg_eltool__customers_customer_id .................. [RUN]
14:31:44.655168 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df"
14:31:44.655380 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:44.655683 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:44.659356 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df"
14:31:44.659759 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.659970 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:44.661535 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df"
14:31:44.661895 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df"
14:31:44.662091 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df: BEGIN
14:31:44.662271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.665603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.665895 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df"
14:31:44.666106 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."warehouse"."stg_eltool__customers"
where customer_id is null



      
    ) dbt_internal_test
14:31:44.667224 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.668581 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.668818 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df: ROLLBACK
14:31:44.669192 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df: Close
14:31:44.669634 [info ] [Thread-1  ]: 5 of 10 PASS not_null_stg_eltool__customers_customer_id ........................ [[32mPASS[0m in 0.01s]
14:31:44.670171 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:44.670435 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:44.670656 [info ] [Thread-1  ]: 6 of 10 START test source_not_null_warehouse_customers_customer_id ............. [RUN]
14:31:44.671215 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
14:31:44.671442 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:44.671755 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:44.675483 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
14:31:44.675875 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.676086 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:44.677790 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
14:31:44.678233 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
14:31:44.678429 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
14:31:44.678620 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.681749 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.681976 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
14:31:44.682170 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
14:31:44.682939 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.684104 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.684332 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
14:31:44.684730 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
14:31:44.685153 [info ] [Thread-1  ]: 6 of 10 PASS source_not_null_warehouse_customers_customer_id ................... [[32mPASS[0m in 0.01s]
14:31:44.685717 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:44.685978 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:44.686205 [info ] [Thread-1  ]: 7 of 10 START test source_not_null_warehouse_orders_order_id ................... [RUN]
14:31:44.686829 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76"
14:31:44.687036 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:44.687231 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:44.691153 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76"
14:31:44.691515 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.691747 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:44.693479 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76"
14:31:44.693807 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76"
14:31:44.694009 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
14:31:44.694198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.697364 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.697619 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76"
14:31:44.697823 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
14:31:44.698845 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.700040 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.700265 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
14:31:44.700681 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
14:31:44.701076 [info ] [Thread-1  ]: 7 of 10 PASS source_not_null_warehouse_orders_order_id ......................... [[32mPASS[0m in 0.01s]
14:31:44.701586 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:44.701817 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:44.702020 [info ] [Thread-1  ]: 8 of 10 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
14:31:44.702520 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
14:31:44.702723 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:44.702919 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:44.710988 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
14:31:44.711626 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.711891 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:44.713684 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
14:31:44.714003 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
14:31:44.714199 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
14:31:44.714380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.717677 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.717900 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
14:31:44.718091 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "dbt"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
14:31:44.719230 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.720381 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.720609 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
14:31:44.721004 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
14:31:44.721420 [info ] [Thread-1  ]: 8 of 10 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.02s]
14:31:44.721936 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:44.722173 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:44.722384 [info ] [Thread-1  ]: 9 of 10 START test source_unique_warehouse_orders_order_id ..................... [RUN]
14:31:44.722893 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f"
14:31:44.723098 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:44.723302 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:44.729840 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f"
14:31:44.730255 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.730474 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:44.732308 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f"
14:31:44.732636 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f"
14:31:44.732834 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
14:31:44.733018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.736354 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.736592 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f"
14:31:44.736783 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
14:31:44.738304 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.739495 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.739743 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
14:31:44.740181 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f: Close
14:31:44.740604 [info ] [Thread-1  ]: 9 of 10 PASS source_unique_warehouse_orders_order_id ........................... [[32mPASS[0m in 0.02s]
14:31:44.741136 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:44.741367 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:44.741573 [info ] [Thread-1  ]: 10 of 10 START test unique_customer_orders_order_id ............................ [RUN]
14:31:44.742062 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc"
14:31:44.742263 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:44.742456 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:44.747026 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc"
14:31:44.747476 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.747707 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:44.749545 [debug] [Thread-1  ]: Writing runtime SQL for node "test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc"
14:31:44.749977 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc"
14:31:44.750181 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc: BEGIN
14:31:44.750395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:44.753777 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:44.754025 [debug] [Thread-1  ]: Using postgres connection "test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc"
14:31:44.754233 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "node_id": "test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."warehouse"."customer_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
14:31:44.756383 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
14:31:44.757631 [debug] [Thread-1  ]: finished collecting timing info
14:31:44.757866 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc: ROLLBACK
14:31:44.758299 [debug] [Thread-1  ]: On test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc: Close
14:31:44.758720 [info ] [Thread-1  ]: 10 of 10 PASS unique_customer_orders_order_id .................................. [[32mPASS[0m in 0.02s]
14:31:44.759269 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:44.762384 [debug] [MainThread]: Acquiring new postgres connection "master"
14:31:44.762629 [debug] [MainThread]: Using postgres connection "master"
14:31:44.762820 [debug] [MainThread]: On master: BEGIN
14:31:44.763003 [debug] [MainThread]: Opening a new connection, currently in state closed
14:31:44.766124 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:31:44.766396 [debug] [MainThread]: On master: COMMIT
14:31:44.766600 [debug] [MainThread]: Using postgres connection "master"
14:31:44.766785 [debug] [MainThread]: On master: COMMIT
14:31:44.767177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:31:44.767390 [debug] [MainThread]: On master: Close
14:31:44.767806 [info ] [MainThread]: 
14:31:44.768238 [info ] [MainThread]: Finished running 10 tests in 0.26s.
14:31:44.768610 [debug] [MainThread]: Connection 'master' was properly closed.
14:31:44.768797 [debug] [MainThread]: Connection 'test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc' was properly closed.
14:31:44.773606 [info ] [MainThread]: 
14:31:44.774024 [info ] [MainThread]: [32mCompleted successfully[0m
14:31:44.774426 [info ] [MainThread]: 
14:31:44.774771 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10


============================== 2022-05-27 14:31:53.341749 | c6eda13e-210a-4fa9-97bc-013353e3ffa2 ==============================
14:31:53.341777 [info ] [MainThread]: Running with dbt=1.1.0
14:31:53.342467 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:31:53.342673 [debug] [MainThread]: Tracking: do not track
14:31:53.378790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:31:53.379130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:31:53.390200 [info ] [MainThread]: Found 6 models, 10 tests, 1 snapshot, 0 analyses, 167 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
14:31:53.392055 [info ] [MainThread]: 
14:31:53.392650 [debug] [MainThread]: Acquiring new postgres connection "master"
14:31:53.393699 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_snapshots"
14:31:53.403504 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
14:31:53.403773 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
14:31:53.403969 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:31:53.407458 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:31:53.407720 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
14:31:53.407909 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
14:31:53.409876 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
14:31:53.411443 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
14:31:53.412138 [debug] [ThreadPool]: On list_dbt_snapshots: Close
14:31:53.412667 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_warehouse"
14:31:53.414229 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
14:31:53.414435 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
14:31:53.414623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:31:53.417816 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:31:53.418059 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
14:31:53.418255 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
14:31:53.420215 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
14:31:53.421343 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
14:31:53.421755 [debug] [ThreadPool]: On list_dbt_warehouse: Close
14:31:53.425842 [debug] [MainThread]: Using postgres connection "master"
14:31:53.426090 [debug] [MainThread]: On master: BEGIN
14:31:53.426279 [debug] [MainThread]: Opening a new connection, currently in state init
14:31:53.429279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:31:53.429515 [debug] [MainThread]: Using postgres connection "master"
14:31:53.429704 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:31:53.441011 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
14:31:53.442365 [debug] [MainThread]: On master: ROLLBACK
14:31:53.442787 [debug] [MainThread]: On master: Close
14:31:53.443185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:31:53.443569 [info ] [MainThread]: 
14:31:53.445278 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__orders
14:31:53.445660 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__orders"
14:31:53.445872 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__orders
14:31:53.446078 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__orders
14:31:53.448350 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__orders"
14:31:53.448703 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.448922 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__orders
14:31:53.449138 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.449550 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__orders
14:31:53.449782 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__state
14:31:53.450091 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
14:31:53.450288 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__state
14:31:53.450475 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__state
14:31:53.452361 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__state"
14:31:53.452839 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.453054 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__state
14:31:53.453252 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.453618 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__state
14:31:53.453844 [debug] [Thread-1  ]: Began running node snapshot.sde_dbt_tutorial.customers_snapshot
14:31:53.454148 [debug] [Thread-1  ]: Acquiring new postgres connection "snapshot.sde_dbt_tutorial.customers_snapshot"
14:31:53.454345 [debug] [Thread-1  ]: Began compiling node snapshot.sde_dbt_tutorial.customers_snapshot
14:31:53.454537 [debug] [Thread-1  ]: Compiling snapshot.sde_dbt_tutorial.customers_snapshot
14:31:53.457270 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.457528 [debug] [Thread-1  ]: Began executing node snapshot.sde_dbt_tutorial.customers_snapshot
14:31:53.457732 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.458157 [debug] [Thread-1  ]: Finished running node snapshot.sde_dbt_tutorial.customers_snapshot
14:31:53.458399 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:53.458705 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
14:31:53.458906 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:53.459098 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:53.471502 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
14:31:53.471918 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.472156 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:53.472376 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.472814 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.source_not_null_warehouse_customers_customer_id.ae7452c4c6
14:31:53.473076 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:53.473410 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76"
14:31:53.473631 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:53.473840 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:53.477582 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76"
14:31:53.478062 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.478301 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:53.478522 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.478954 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.source_not_null_warehouse_orders_order_id.c85a1f0b76
14:31:53.479206 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:53.479534 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
14:31:53.479764 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:53.479985 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:53.488054 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
14:31:53.488410 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.488641 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:53.488858 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.489269 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
14:31:53.489524 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:53.489857 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f"
14:31:53.490076 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:53.490389 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:53.497324 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f"
14:31:53.497674 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.497893 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:53.498093 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.498496 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.source_unique_warehouse_orders_order_id.839fb43d0f
14:31:53.498732 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.fct_orders
14:31:53.499035 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.fct_orders"
14:31:53.499246 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.fct_orders
14:31:53.499438 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.fct_orders
14:31:53.501282 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.fct_orders"
14:31:53.501641 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.501847 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.fct_orders
14:31:53.502044 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.502423 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.fct_orders
14:31:53.502652 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__customers
14:31:53.502956 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__customers"
14:31:53.503156 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__customers
14:31:53.503345 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__customers
14:31:53.505185 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__customers"
14:31:53.505486 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.505694 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__customers
14:31:53.505890 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.506262 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__customers
14:31:53.506697 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.dim_customers
14:31:53.506995 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.dim_customers"
14:31:53.507192 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.dim_customers
14:31:53.507379 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.dim_customers
14:31:53.509421 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.dim_customers"
14:31:53.509745 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.509953 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.dim_customers
14:31:53.510151 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.510549 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.dim_customers
14:31:53.510781 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:53.511081 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df"
14:31:53.511282 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:53.511474 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:53.515501 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df"
14:31:53.516739 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.517129 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:53.517392 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.518156 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.not_null_stg_eltool__customers_customer_id.4bd58324df
14:31:53.518495 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.customer_orders
14:31:53.518971 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.customer_orders"
14:31:53.519185 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.customer_orders
14:31:53.519382 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.customer_orders
14:31:53.522392 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.customer_orders"
14:31:53.522858 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.523206 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.customer_orders
14:31:53.523469 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.524522 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.customer_orders
14:31:53.524768 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:53.525105 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss"
14:31:53.525310 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:53.525508 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:53.528192 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss"
14:31:53.528610 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.528827 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:53.529028 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.529423 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss
14:31:53.529656 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:53.529960 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d"
14:31:53.530163 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:53.530356 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:53.533733 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d"
14:31:53.534373 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.534594 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:53.534798 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.535176 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.not_null_dim_customers_customer_id.dd91cd1c8d
14:31:53.535464 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:53.535785 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3"
14:31:53.535989 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:53.536177 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:53.545938 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3"
14:31:53.546367 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.546591 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:53.546793 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.547224 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.accepted_values_customer_orders_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.55819769c3
14:31:53.547462 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:53.547779 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0"
14:31:53.547987 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:53.548181 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:53.551572 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0"
14:31:53.551980 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.552200 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:53.552400 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.552780 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.not_null_customer_orders_customer_id.582e6bcaa0
14:31:53.553010 [debug] [Thread-1  ]: Began running node test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:53.553315 [debug] [Thread-1  ]: Acquiring new postgres connection "test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc"
14:31:53.553516 [debug] [Thread-1  ]: Began compiling node test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:53.553707 [debug] [Thread-1  ]: Compiling test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:53.557026 [debug] [Thread-1  ]: Writing injected SQL for node "test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc"
14:31:53.557411 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.557623 [debug] [Thread-1  ]: Began executing node test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:53.557824 [debug] [Thread-1  ]: finished collecting timing info
14:31:53.558218 [debug] [Thread-1  ]: Finished running node test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc
14:31:53.649499 [debug] [MainThread]: Connection 'master' was properly closed.
14:31:53.650668 [debug] [MainThread]: Connection 'test.sde_dbt_tutorial.unique_customer_orders_order_id.352340f7cc' was properly closed.
14:31:53.672602 [info ] [MainThread]: Done.
14:31:53.676628 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
14:31:53.677081 [info ] [MainThread]: Building catalog
14:31:53.682384 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
14:31:53.692502 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
14:31:53.692847 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
14:31:53.693117 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:31:53.697812 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:31:53.698173 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
14:31:53.698451 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('snapshots') or upper(sch.nspname) = upper('warehouse'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
14:31:53.702653 [debug] [ThreadPool]: SQL status: SELECT 75 in 0.0 seconds
14:31:53.715263 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
14:31:53.716011 [debug] [ThreadPool]: On dbt.information_schema: Close
14:31:53.727507 [info ] [MainThread]: Catalog written to /home/andrew/PycharmProjects/simple_dbt_project/sde_dbt_tutorial/target/catalog.json
14:31:53.728351 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
14:31:53.728619 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2022-05-27 14:31:58.696123 | bb5a65f3-fce0-420e-b62c-4fe835a91032 ==============================
14:31:58.696149 [info ] [MainThread]: Running with dbt=1.1.0
14:31:58.696916 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
14:31:58.697147 [debug] [MainThread]: Tracking: do not track
14:31:58.705449 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
14:31:58.706057 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
14:31:58.706429 [info ] [MainThread]: 
14:31:58.706772 [info ] [MainThread]: 
14:31:58.707128 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-31 13:31:42.102814 | 8e9a022e-8c25-45bf-8c32-e770dd19f978 ==============================
13:31:42.102833 [info ] [MainThread]: Running with dbt=1.1.0
13:31:42.103430 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
13:31:42.103628 [debug] [MainThread]: Tracking: do not track
13:31:42.164326 [debug] [MainThread]: Partial parsing enabled: 8 files deleted, 0 files added, 3 files changed.
13:31:42.164894 [debug] [MainThread]: Partial parsing: update schema file: sde_dbt_tutorial://models/staging/stg_eltool.yml
13:31:42.165248 [debug] [MainThread]: Partial parsing: deleted source source.sde_dbt_tutorial.warehouse.customers
13:31:42.165455 [debug] [MainThread]: Partial parsing: deleted source source.sde_dbt_tutorial.warehouse.orders
13:31:42.165747 [debug] [MainThread]: Partial parsing: deleted source source.sde_dbt_tutorial.warehouse.state
13:31:42.165960 [debug] [MainThread]: Partial parsing: update schema file: sde_dbt_tutorial://models/staging/src_eltool.yml
13:31:42.166224 [debug] [MainThread]: Partial parsing: deleted file: sde_dbt_tutorial://models/marts/marketing/customer_orders.sql
13:31:42.166499 [debug] [MainThread]: Partial parsing: deleted file: sde_dbt_tutorial://models/staging/stg_eltool__customers.sql
13:31:42.166703 [debug] [MainThread]: Partial parsing: deleted file: sde_dbt_tutorial://models/marts/core/dim_customers.sql
13:31:42.166899 [debug] [MainThread]: Partial parsing: deleted file: sde_dbt_tutorial://models/staging/stg_eltool__orders.sql
13:31:42.167089 [debug] [MainThread]: Partial parsing: deleted file: sde_dbt_tutorial://models/marts/core/fct_orders.sql
13:31:42.167275 [debug] [MainThread]: Partial parsing: deleted file: sde_dbt_tutorial://snapshots/customers.sql
13:31:42.167528 [debug] [MainThread]: Partial parsing: updated file: sde_dbt_tutorial://models/staging/stg_eltool__state.sql
13:31:42.179938 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql


============================== 2022-05-31 13:32:26.465448 | 8ea8f472-2317-4b91-b333-b609db51e8e7 ==============================
13:32:26.465471 [info ] [MainThread]: Running with dbt=1.1.0
13:32:26.466100 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
13:32:26.466306 [debug] [MainThread]: Tracking: do not track
13:32:26.487661 [info ] [MainThread]: Unable to do partial parsing because profile has changed
13:32:26.496619 [debug] [MainThread]: Parsing macros/relations.sql
13:32:26.498486 [debug] [MainThread]: Parsing macros/adapters.sql
13:32:26.519887 [debug] [MainThread]: Parsing macros/catalog.sql
13:32:26.522055 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
13:32:26.523708 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:32:26.526607 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:32:26.529324 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:32:26.536577 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:32:26.546373 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:32:26.556309 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:32:26.560796 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:32:26.563074 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:32:26.566983 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:32:26.569353 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:32:26.572161 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:32:26.574510 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:32:26.575856 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:32:26.582434 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:32:26.585341 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:32:26.592279 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:32:26.607093 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:32:26.621225 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:32:26.625656 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:32:26.627182 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:32:26.636812 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:32:26.638458 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:32:26.648442 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:32:26.664547 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:32:26.676329 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:32:26.691686 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:32:26.697505 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:32:26.701799 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:32:26.703613 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:32:26.705391 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:32:26.713194 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:32:26.717521 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:32:26.719070 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:32:26.721521 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:32:26.722992 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:32:26.723729 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:32:26.725206 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:32:26.726131 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:32:26.726987 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:32:26.915898 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql


============================== 2022-05-31 13:33:15.444617 | f7428adc-480b-402a-a439-2f5f4d209413 ==============================
13:33:15.444639 [info ] [MainThread]: Running with dbt=1.1.0
13:33:15.445259 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
13:33:15.445487 [debug] [MainThread]: Tracking: do not track
13:33:15.465824 [info ] [MainThread]: Unable to do partial parsing because profile has changed
13:33:15.474781 [debug] [MainThread]: Parsing macros/relations.sql
13:33:15.476587 [debug] [MainThread]: Parsing macros/adapters.sql
13:33:15.497554 [debug] [MainThread]: Parsing macros/catalog.sql
13:33:15.499692 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
13:33:15.501322 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:33:15.504192 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:33:15.506909 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:33:15.514154 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:33:15.523400 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:33:15.532681 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:33:15.537047 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:33:15.539242 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:33:15.543021 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:33:15.545345 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:33:15.548088 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:33:15.550381 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:33:15.551728 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:33:15.558226 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:33:15.561074 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:33:15.567929 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:33:15.582519 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:33:15.596486 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:33:15.600827 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:33:15.602341 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:33:15.611810 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:33:15.613425 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:33:15.623260 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:33:15.639104 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:33:15.650715 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:33:15.665958 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:33:15.671739 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:33:15.676055 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:33:15.677873 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:33:15.679588 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:33:15.687259 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:33:15.691502 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:33:15.693065 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:33:15.695473 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:33:15.696950 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:33:15.697719 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:33:15.699172 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:33:15.700049 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:33:15.700901 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:33:15.885698 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
13:33:15.930374 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss' (tests/assert_customer_dimension_has_no_row_loss.sql) depends on a node named 'dim_customers' which was not found
13:33:15.930815 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss' (tests/assert_customer_dimension_has_no_row_loss.sql) depends on a node named 'stg_eltool__customers' which was not found
13:33:15.931156 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss' (tests/assert_customer_dimension_has_no_row_loss.sql) depends on a node named 'stg_eltool__customers' which was not found
13:33:15.931532 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.sde_dbt_tutorial.assert_customer_dimension_has_no_row_loss' (tests/assert_customer_dimension_has_no_row_loss.sql) depends on a node named 'dim_customers' which was not found
13:33:15.940559 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sde_dbt_tutorial.marts.core

13:33:15.949285 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
13:33:15.950421 [info ] [MainThread]: 
13:33:15.950997 [debug] [MainThread]: Acquiring new postgres connection "master"
13:33:15.951648 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
13:33:15.960314 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
13:33:15.960522 [debug] [ThreadPool]: On list_postgres_public: BEGIN
13:33:15.960705 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:33:15.971004 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
13:33:15.971281 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
13:33:15.971471 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
13:33:15.977469 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
13:33:15.982498 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
13:33:15.982956 [debug] [ThreadPool]: On list_postgres_public: Close
13:33:15.986623 [debug] [MainThread]: Using postgres connection "master"
13:33:15.986862 [debug] [MainThread]: On master: BEGIN
13:33:15.987045 [debug] [MainThread]: Opening a new connection, currently in state init
13:33:15.990224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:33:15.990460 [debug] [MainThread]: Using postgres connection "master"
13:33:15.990647 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:33:15.999221 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
13:33:16.000284 [debug] [MainThread]: On master: ROLLBACK
13:33:16.000754 [debug] [MainThread]: On master: Close
13:33:16.001196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:33:16.001611 [info ] [MainThread]: 
13:33:16.008245 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__state
13:33:16.008683 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
13:33:16.008906 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__state
13:33:16.009123 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__state
13:33:16.011288 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__state"
13:33:16.011633 [debug] [Thread-1  ]: finished collecting timing info
13:33:16.011840 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__state
13:33:16.012043 [debug] [Thread-1  ]: finished collecting timing info
13:33:16.012445 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__state
13:33:16.108693 [debug] [MainThread]: Connection 'master' was properly closed.
13:33:16.109757 [debug] [MainThread]: Connection 'model.sde_dbt_tutorial.stg_eltool__state' was properly closed.
13:33:16.125501 [info ] [MainThread]: Done.


============================== 2022-05-31 13:34:23.759155 | 01ae52b6-efe6-4e25-8be9-7dc22475e1ad ==============================
13:34:23.759195 [info ] [MainThread]: Running with dbt=1.1.0
13:34:23.759836 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
13:34:23.760048 [debug] [MainThread]: Tracking: do not track
13:34:23.789363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:34:23.789760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:34:23.790199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sde_dbt_tutorial.marts.core

13:34:23.800065 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
13:34:23.801173 [info ] [MainThread]: 
13:34:23.801772 [debug] [MainThread]: Acquiring new postgres connection "master"
13:34:23.802452 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
13:34:23.812614 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
13:34:23.812874 [debug] [ThreadPool]: On list_postgres_public: BEGIN
13:34:23.813068 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:34:23.816837 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:34:23.817132 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
13:34:23.817350 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
13:34:23.819296 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
13:34:23.820636 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
13:34:23.821033 [debug] [ThreadPool]: On list_postgres_public: Close
13:34:23.825331 [debug] [MainThread]: Using postgres connection "master"
13:34:23.825611 [debug] [MainThread]: On master: BEGIN
13:34:23.825796 [debug] [MainThread]: Opening a new connection, currently in state init
13:34:23.828927 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:34:23.829177 [debug] [MainThread]: Using postgres connection "master"
13:34:23.829388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:34:23.834480 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
13:34:23.835606 [debug] [MainThread]: On master: ROLLBACK
13:34:23.836073 [debug] [MainThread]: On master: Close
13:34:23.836519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:34:23.836907 [info ] [MainThread]: 
13:34:23.839627 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__state
13:34:23.840060 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
13:34:23.840286 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__state
13:34:23.840501 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__state
13:34:23.842719 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__state"
13:34:23.843118 [debug] [Thread-1  ]: finished collecting timing info
13:34:23.843333 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__state
13:34:23.843543 [debug] [Thread-1  ]: finished collecting timing info
13:34:23.843968 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__state
13:34:23.940091 [debug] [MainThread]: Connection 'master' was properly closed.
13:34:23.941486 [debug] [MainThread]: Connection 'model.sde_dbt_tutorial.stg_eltool__state' was properly closed.
13:34:23.958397 [info ] [MainThread]: Done.


============================== 2022-05-31 13:35:25.969482 | 8885d937-594b-4043-b7b5-59ed0563618e ==============================
13:35:25.969510 [info ] [MainThread]: Running with dbt=1.1.0
13:35:25.970172 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
13:35:25.970377 [debug] [MainThread]: Tracking: do not track
13:35:25.999822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:35:26.000357 [debug] [MainThread]: Partial parsing: updated file: sde_dbt_tutorial://models/staging/stg_eltool__state.sql
13:35:26.010831 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
13:35:26.031520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sde_dbt_tutorial.marts.core

13:35:26.039902 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
13:35:26.040946 [info ] [MainThread]: 
13:35:26.041521 [debug] [MainThread]: Acquiring new postgres connection "master"
13:35:26.042175 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
13:35:26.052410 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
13:35:26.052689 [debug] [ThreadPool]: On list_postgres_public: BEGIN
13:35:26.052895 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:35:26.056940 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:35:26.057205 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
13:35:26.057423 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
13:35:26.059312 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
13:35:26.060579 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
13:35:26.061017 [debug] [ThreadPool]: On list_postgres_public: Close
13:35:26.064713 [debug] [MainThread]: Using postgres connection "master"
13:35:26.064950 [debug] [MainThread]: On master: BEGIN
13:35:26.065143 [debug] [MainThread]: Opening a new connection, currently in state init
13:35:26.068273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:35:26.068524 [debug] [MainThread]: Using postgres connection "master"
13:35:26.068717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:35:26.073328 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
13:35:26.074491 [debug] [MainThread]: On master: ROLLBACK
13:35:26.074909 [debug] [MainThread]: On master: Close
13:35:26.075334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:35:26.075726 [info ] [MainThread]: 
13:35:26.077378 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__state
13:35:26.077888 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
13:35:26.078105 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__state
13:35:26.078309 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__state
13:35:26.080341 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__state"
13:35:26.080703 [debug] [Thread-1  ]: finished collecting timing info
13:35:26.080914 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__state
13:35:26.081126 [debug] [Thread-1  ]: finished collecting timing info
13:35:26.081543 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__state
13:35:26.177853 [debug] [MainThread]: Connection 'master' was properly closed.
13:35:26.178918 [debug] [MainThread]: Connection 'model.sde_dbt_tutorial.stg_eltool__state' was properly closed.
13:35:26.194633 [info ] [MainThread]: Done.


============================== 2022-05-31 13:37:08.940801 | c2507456-1c52-427b-a23b-791945bfc9e9 ==============================
13:37:08.940820 [info ] [MainThread]: Running with dbt=1.1.0
13:37:08.941424 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
13:37:08.941662 [debug] [MainThread]: Tracking: do not track
13:37:08.970453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:37:08.970765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:37:08.971170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sde_dbt_tutorial.marts.core

13:37:08.980004 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
13:37:08.980952 [info ] [MainThread]: 
13:37:08.981336 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args


============================== 2022-05-31 13:37:48.835843 | 58d006d9-1723-4c4f-9ee2-eb8800ea4f37 ==============================
13:37:48.835862 [info ] [MainThread]: Running with dbt=1.1.0
13:37:48.836432 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/andrew/PycharmProjects/simple_dbt_project', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
13:37:48.836627 [debug] [MainThread]: Tracking: do not track
13:37:48.865768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:37:48.866089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:37:48.866510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sde_dbt_tutorial.marts.core

13:37:48.876085 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
13:37:48.877138 [info ] [MainThread]: 
13:37:48.877740 [debug] [MainThread]: Acquiring new postgres connection "master"
13:37:48.878382 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
13:37:48.887957 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
13:37:48.888195 [debug] [ThreadPool]: On list_postgres_public: BEGIN
13:37:48.888380 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:37:48.891712 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:37:48.891998 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
13:37:48.892190 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
13:37:48.894369 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
13:37:48.895856 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
13:37:48.896239 [debug] [ThreadPool]: On list_postgres_public: Close
13:37:48.899782 [debug] [MainThread]: Using postgres connection "master"
13:37:48.900001 [debug] [MainThread]: On master: BEGIN
13:37:48.900184 [debug] [MainThread]: Opening a new connection, currently in state init
13:37:48.903284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:37:48.903532 [debug] [MainThread]: Using postgres connection "master"
13:37:48.903718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "sde_dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:37:48.908337 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
13:37:48.909370 [debug] [MainThread]: On master: ROLLBACK
13:37:48.909832 [debug] [MainThread]: On master: Close
13:37:48.910245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:37:48.910625 [info ] [MainThread]: 
13:37:48.912527 [debug] [Thread-1  ]: Began running node model.sde_dbt_tutorial.stg_eltool__state
13:37:48.912925 [debug] [Thread-1  ]: Acquiring new postgres connection "model.sde_dbt_tutorial.stg_eltool__state"
13:37:48.913134 [debug] [Thread-1  ]: Began compiling node model.sde_dbt_tutorial.stg_eltool__state
13:37:48.913344 [debug] [Thread-1  ]: Compiling model.sde_dbt_tutorial.stg_eltool__state
13:37:48.915614 [debug] [Thread-1  ]: Writing injected SQL for node "model.sde_dbt_tutorial.stg_eltool__state"
13:37:48.915991 [debug] [Thread-1  ]: finished collecting timing info
13:37:48.916199 [debug] [Thread-1  ]: Began executing node model.sde_dbt_tutorial.stg_eltool__state
13:37:48.916402 [debug] [Thread-1  ]: finished collecting timing info
13:37:48.916812 [debug] [Thread-1  ]: Finished running node model.sde_dbt_tutorial.stg_eltool__state
13:37:49.012968 [debug] [MainThread]: Connection 'master' was properly closed.
13:37:49.014045 [debug] [MainThread]: Connection 'model.sde_dbt_tutorial.stg_eltool__state' was properly closed.
13:37:49.028148 [info ] [MainThread]: Done.
